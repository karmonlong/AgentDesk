# 🤖 多智能体协作系统 - 使用指南

## 📋 概述

这是一个基于 **LangGraph 1.0** 和 **Kimi AI** 的多智能体协作系统，提供类似 AI IDE 的 @ 交互体验。不同于传统的单一 AI 助手，我们的系统由多个专业智能体组成，每个智能体都有独特的专长和人格。

## ✨ 核心亮点

### 1. **多智能体团队协作**
- 6个专业智能体，各有专长
- 自动路由或手动 @ 指定
- 智能体之间可以协作完成复杂任务

### 2. **类似 AI IDE 的 @ 交互**
```
用户: @文档分析师 帮我总结这份报告
用户: @内容创作者 写一封感谢邮件
用户: @数据专家 分析销售趋势
```

### 3. **持续对话与上下文记忆**
- 保持对话历史
- 支持追问和迭代优化
- 智能体记住之前的交互

### 4. **智能路由系统**
- 不指定智能体时自动选择
- 基于关键词和语义理解
- 始终选择最合适的专家

## 👥 智能体团队

### 📊 文档分析师
**专长**: 信息提取与分析
- 快速提取文档核心信息
- 生成结构化摘要
- 识别关键实体（人名、日期、金额等）
- 分析文档主题和意图

**使用场景**:
```
@文档分析师 总结这份报告的要点
@文档分析师 提取这份合同中的关键条款
@文档分析师 分析这份会议纪要
```

### ✍️ 内容创作者
**专长**: 专业内容撰写
- 撰写各类商务文档（报告、邮件、提案）
- 内容改写和润色
- 根据受众调整风格
- 创意文案生成

**使用场景**:
```
@内容创作者 写一封客户感谢信
@内容创作者 帮我润色这段文字
@内容创作者 生成一份项目提案
```

### 📈 数据专家
**专长**: 数据分析与洞察
- 提取和分析表格数据
- 识别数据趋势和异常
- 生成数据洞察
- 设计可视化方案

**使用场景**:
```
@数据专家 分析这份销售数据
@数据专家 这些数字背后的趋势是什么
@数据专家 建议如何可视化这些数据
```

### ✅ 校对编辑
**专长**: 内容质量把控
- 检查语法、拼写、标点
- 优化句式和表达
- 确保逻辑连贯
- 提升可读性

**使用场景**:
```
@校对编辑 检查这份文档的错误
@校对编辑 帮我优化这段话的表达
@校对编辑 这篇文章有什么问题
```

### 🌐 翻译专家
**专长**: 专业翻译与本地化
- 中英文双向翻译
- 保持原文风格
- 专业术语准确
- 文化本地化

**使用场景**:
```
@翻译专家 翻译这段英文
@翻译专家 把这封邮件翻译成英文
@翻译专家 这个术语怎么翻译最合适
```

### 🎯 协调者
**专长**: 任务分配与协调
- 理解复杂需求
- 分配任务给合适的智能体
- 协调多智能体协作
- 整合多个输出

**使用场景**:
```
@协调者 帮我完成一个复杂的文档处理任务
@协调者 这个需求应该找哪个智能体
```

## 🚀 使用方法

### 1. 访问聊天界面

```bash
# 启动服务器
python app.py

# 打开浏览器访问
http://localhost:8000/chat
```

### 2. 三种交互方式

#### 方式一：自动路由（推荐新手）
直接说出你的需求，系统自动选择合适的智能体：

```
用户: 帮我总结这份报告
系统: → 自动选择 文档分析师

用户: 写一封感谢邮件
系统: → 自动选择 内容创作者
```

#### 方式二：@ 提及（精确控制）
使用 `@智能体名称` 来指定特定专家：

```
@文档分析师 分析这份文档
@内容创作者 帮我写一篇文章
@数据专家 分析这些数字
```

#### 方式三：点击选择
在左侧智能体列表中点击，自动插入 @ 提及

### 3. 上传文档协作

1. 点击输入框的 📎 按钮
2. 上传文档（支持 TXT, PDF, DOCX, MD）
3. 智能体可以分析文档内容
4. 进行多轮对话，迭代优化

### 4. 持续对话

```
用户: @文档分析师 总结这份报告
智能体: [提供总结]

用户: 能再详细一点吗？
智能体: [基于上下文，提供更详细的总结]

用户: 重点关注财务数据
智能体: [调整焦点，重新总结]
```

## 💡 使用技巧

### 1. 明确指定需求
```
❌ 差: "看看这个"
✅ 好: "@文档分析师 提取这份合同的关键条款"
```

### 2. 利用专长
```
分析阶段: @文档分析师
创作阶段: @内容创作者
检查阶段: @校对编辑
```

### 3. 提供上下文
```
@内容创作者 写一封感谢邮件
给客户的，正式但温暖，感谢他们的支持
```

### 4. 多轮迭代
```
1. 第一轮: 生成初稿
2. 第二轮: 调整风格
3. 第三轮: 优化细节
```

## 🔗 API 使用

### 1. 获取智能体列表

```bash
curl http://localhost:8000/api/agents
```

响应:
```json
{
  "success": true,
  "agents": [
    {
      "name": "文档分析师",
      "role": "信息提取与分析专家",
      "emoji": "📊",
      "mention": "@文档分析师"
    },
    ...
  ]
}
```

### 2. 发送聊天消息

```bash
curl -X POST http://localhost:8000/api/chat \
  -F "message=帮我总结这段文字"
```

响应:
```json
{
  "success": true,
  "agent": {
    "name": "文档分析师",
    "role": "信息提取与分析专家",
    "emoji": "📊"
  },
  "response": "...",
  "routing_info": {
    "type": "auto",
    "reason": "根据关键词自动选择了文档分析师"
  }
}
```

### 3. 带文档的聊天

```bash
curl -X POST http://localhost:8000/api/chat \
  -F "message=分析这份文档" \
  -F "document=@report.txt"
```

### 4. 清除对话历史

```bash
curl -X POST http://localhost:8000/api/chat/clear
```

## 🎨 界面特性

### 1. 美观的聊天界面
- 现代化渐变设计
- 流畅的动画效果
- 响应式布局

### 2. 智能体卡片
- 左侧显示所有智能体
- 点击快速选择
- 实时显示状态

### 3. Markdown 渲染
- 自动渲染 Markdown 格式
- 支持代码高亮
- 支持表格和列表

### 4. @ 提及辅助
- 输入 @ 自动显示建议
- 快速选择智能体
- 智能补全

## 🔧 技术架构

### 核心组件

```
┌─────────────────────────────────────┐
│     Web 界面 (chat.html)            │
│  - Bootstrap 5 设计                 │
│  - 实时消息渲染                     │
│  - @ 提及自动补全                   │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│   FastAPI 后端 (app.py)             │
│  - /chat 页面路由                   │
│  - /api/chat 聊天API                │
│  - /api/agents 智能体列表           │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│  多智能体系统 (multi_agents.py)     │
│  ├─ AgentRegistry (注册中心)        │
│  ├─ AgentRouter (路由器)            │
│  ├─ ConversationManager (对话管理)  │
│  └─ 6个专业智能体                   │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│      Kimi AI (LLM 引擎)             │
│  - kimi-k2-thinking-turbo           │
│  - 智能推理和生成                   │
└─────────────────────────────────────┘
```

### 关键类

1. **Agent**: 智能体基类
2. **AgentRegistry**: 智能体注册和管理
3. **AgentRouter**: 智能路由（@ 解析 + 自动选择）
4. **ConversationManager**: 对话历史和上下文
5. **MultiAgentSystem**: 统一入口

## 📊 与传统系统的对比

| 特性 | 传统 ChatPDF/AI IDE | 我们的多智能体系统 |
|------|-------------------|------------------|
| **交互方式** | 单一对话 | @ 提及 + 自动路由 |
| **专业性** | 通用AI | 6个专业智能体 |
| **上下文** | 基础 | 完整对话历史 |
| **协作** | 无 | 多智能体协作 |
| **用户体验** | 普通 | 类似 AI IDE |
| **可扩展性** | 低 | 高（轻松添加新智能体） |

## 🌟 未来规划

- [ ] **智能体协作可视化**: 显示智能体工作流程
- [ ] **自定义智能体**: 用户创建个性化智能体
- [ ] **工作流模板**: 预定义的智能体协作流程
- [ ] **语音交互**: 支持语音输入输出
- [ ] **多模态支持**: 图片、视频分析
- [ ] **团队协作**: 多人共享智能体团队

## 💬 示例对话

### 场景1：处理商务文档

```
用户: @文档分析师 分析这份季度报告
分析师: [提取关键数据和趋势]

用户: @数据专家 这些数据的增长趋势如何
数据专家: [深度数据分析]

用户: @内容创作者 基于这些分析写一份总结报告
创作者: [生成报告草稿]

用户: @校对编辑 检查一下这份报告
编辑: [提出修改建议]
```

### 场景2：国际业务

```
用户: @内容创作者 写一封商务邮件给客户
创作者: [生成中文邮件]

用户: @翻译专家 翻译成英文
翻译: [提供专业翻译]

用户: @校对编辑 检查英文版本
编辑: [检查并优化]
```

## 🎯 总结

这个多智能体系统将"工具"提升为"智能助手团队"，通过：

1. **专业分工**: 每个智能体专注于特定领域
2. **灵活交互**: @ 提及 + 自动路由
3. **持续对话**: 记住上下文，支持迭代
4. **协作能力**: 多个智能体配合完成复杂任务

让用户感受到的不是一个简单的 AI 工具，而是一个真正的**专业团队**在为他们服务！

---

**立即体验**: 访问 `http://localhost:8000/chat` 开始与智能体团队协作！

