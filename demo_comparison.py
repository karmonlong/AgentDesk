"""
é€šç”¨æ™ºèƒ½ä½“ vs ä¸“ä¸šæ™ºèƒ½ä½“ - å®é™…æ•ˆæœå¯¹æ¯”æ¼”ç¤º
"""

from agents.multi_agents import multi_agent_system
from langchain_google_genai import ChatGoogleGenerativeAI
from langchain_core.messages import HumanMessage, SystemMessage
import os
from dotenv import load_dotenv

load_dotenv()


class GenericAgent:
    """é€šç”¨æ™ºèƒ½ä½“ - ä»€ä¹ˆéƒ½åšï¼Œä½†ä¸å¤Ÿä¸“ä¸š"""
    
    def __init__(self):
        self.llm = ChatGoogleGenerativeAI(
            model=os.getenv("GEMINI_MODEL", "gemini-1.5-flash-latest"),
            temperature=0.5,  # å¦¥åçš„æ¸©åº¦å€¼
            google_api_key=os.getenv("GEMINI_API_KEY"),
            convert_system_message_to_human=True
        )
        
        # é€šç”¨çš„ã€å®½æ³›çš„æç¤ºè¯
        self.system_prompt = """ä½ æ˜¯ä¸€ä¸ªé€šç”¨AIåŠ©æ‰‹ã€‚
ä½ å¯ä»¥å¸®åŠ©ç”¨æˆ·å®Œæˆå„ç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬ï¼š
- åˆ†ææ–‡æ¡£
- æ’°å†™å†…å®¹
- ç¿»è¯‘æ–‡å­—
- åˆ†ææ•°æ®
- æ£€æŸ¥é”™è¯¯

è¯·æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚å°½åŠ›å®Œæˆä»»åŠ¡ã€‚"""
    
    def process(self, task: str) -> str:
        """å¤„ç†ä»»åŠ¡"""
        messages = [
            SystemMessage(content=self.system_prompt),
            HumanMessage(content=task)
        ]
        response = self.llm.invoke(messages)
        return response.content


def compare_analysis_task():
    """å¯¹æ¯”ä»»åŠ¡1ï¼šæ–‡æ¡£åˆ†æ"""
    print("\n" + "="*80)
    print("ğŸ“Š å¯¹æ¯”æµ‹è¯• 1: æ–‡æ¡£åˆ†æä»»åŠ¡")
    print("="*80)
    
    document = """
    2024å¹´Q3ä¸šç»©æŠ¥å‘Š
    
    æŠ¥å‘Šæ—¥æœŸï¼š2024å¹´10æœˆ15æ—¥
    æŠ¥å‘Šäººï¼šå¼ ç»ç†
    
    æœ¬å­£åº¦æ€»è¥æ”¶è¾¾åˆ°1,250ä¸‡å…ƒäººæ°‘å¸ï¼ŒåŒæ¯”å¢é•¿35%ï¼Œç¯æ¯”å¢é•¿12%ã€‚
    
    äº§å“è¡¨ç°ï¼š
    - æ ¸å¿ƒäº§å“Aè¥æ”¶800ä¸‡å…ƒ
    - æ–°äº§å“Bè¥æ”¶450ä¸‡å…ƒ
    - äº§å“æ»¡æ„åº¦4.6/5.0
    
    ç”¨æˆ·æ•°æ®ï¼š
    - æ´»è·ƒç”¨æˆ·45,200äºº
    - æ–°å¢ç”¨æˆ·5,800äºº
    - ç”¨æˆ·ç•™å­˜ç‡78%
    
    ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼š
    1. 2024å¹´12æœˆ31æ—¥å‰å®Œæˆäº§å“Cçš„ç ”å‘
    2. 2025å¹´Q1å¯åŠ¨æµ·å¤–å¸‚åœºæ‹“å±•
    3. ä¼˜åŒ–ç”¨æˆ·è·å–æˆæœ¬ï¼Œç›®æ ‡é™ä½20%
    """
    
    task = "è¯·åˆ†æè¿™ä»½å­£åº¦æŠ¥å‘Šï¼Œæå–å…³é”®ä¿¡æ¯"
    
    # é€šç”¨æ™ºèƒ½ä½“
    print("\nğŸ¤– é€šç”¨æ™ºèƒ½ä½“çš„è¾“å‡ºï¼š")
    print("-" * 80)
    generic_agent = GenericAgent()
    generic_result = generic_agent.process(f"{task}\n\n{document}")
    print(generic_result)
    
    # ä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆæ–‡æ¡£åˆ†æå¸ˆï¼‰
    print("\n" + "="*80)
    print("ğŸ“Š ä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆæ–‡æ¡£åˆ†æå¸ˆï¼‰çš„è¾“å‡ºï¼š")
    print("-" * 80)
    specialist_result = multi_agent_system.chat(
        f"@æ–‡æ¡£åˆ†æå¸ˆ {task}\n\n{document}"
    )
    if specialist_result["success"]:
        print(specialist_result["response"])
    
    print("\n" + "="*80)
    print("ğŸ’¡ å¯¹æ¯”åˆ†æï¼š")
    print("-" * 80)
    print("é€šç”¨æ™ºèƒ½ä½“ï¼š")
    print("  âŒ è¾“å‡ºæ ¼å¼ä¸ç»Ÿä¸€")
    print("  âŒ å¯èƒ½é—æ¼é‡è¦æ•°æ®")
    print("  âŒ ç¼ºä¹ç»“æ„åŒ–")
    print("  âŒ ä¸“ä¸šåº¦ä¸€èˆ¬")
    print("\nä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆæ–‡æ¡£åˆ†æå¸ˆï¼‰ï¼š")
    print("  âœ… ä¸¥æ ¼çš„Markdownæ ¼å¼")
    print("  âœ… æ•°æ®é©±åŠ¨ï¼Œçªå‡ºå…³é”®æ•°å­—")
    print("  âœ… æ¸…æ™°çš„å±‚çº§ç»“æ„")
    print("  âœ… ä¸“ä¸šçš„åˆ†æé£æ ¼")
    print("="*80)


def compare_writing_task():
    """å¯¹æ¯”ä»»åŠ¡2ï¼šå†…å®¹æ’°å†™"""
    print("\n" + "="*80)
    print("âœï¸  å¯¹æ¯”æµ‹è¯• 2: å†…å®¹æ’°å†™ä»»åŠ¡")
    print("="*80)
    
    task = "å†™ä¸€å°ç»™å®¢æˆ·çš„æ„Ÿè°¢ä¿¡ï¼Œæ„Ÿè°¢ä»–ä»¬åœ¨ä¸Šå­£åº¦çš„æ”¯æŒå’Œåˆä½œ"
    
    # é€šç”¨æ™ºèƒ½ä½“
    print("\nğŸ¤– é€šç”¨æ™ºèƒ½ä½“çš„è¾“å‡ºï¼š")
    print("-" * 80)
    generic_agent = GenericAgent()
    generic_result = generic_agent.process(task)
    print(generic_result)
    
    # ä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆå†…å®¹åˆ›ä½œè€…ï¼‰
    print("\n" + "="*80)
    print("âœï¸  ä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆå†…å®¹åˆ›ä½œè€…ï¼‰çš„è¾“å‡ºï¼š")
    print("-" * 80)
    specialist_result = multi_agent_system.chat(f"@å†…å®¹åˆ›ä½œè€… {task}")
    if specialist_result["success"]:
        print(specialist_result["response"])
    
    print("\n" + "="*80)
    print("ğŸ’¡ å¯¹æ¯”åˆ†æï¼š")
    print("-" * 80)
    print("é€šç”¨æ™ºèƒ½ä½“ï¼š")
    print("  âŒ æ¨¡æ¿åŒ–ï¼Œç¼ºä¹ä¸ªæ€§")
    print("  âŒ å†…å®¹ç¬¼ç»Ÿï¼Œä¸å¤Ÿå…·ä½“")
    print("  âŒ ç¼ºä¹æƒ…æ„Ÿæ¸©åº¦")
    print("  âŒ åˆ›æ„ä¸è¶³")
    print("\nä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆå†…å®¹åˆ›ä½œè€…ï¼‰ï¼š")
    print("  âœ… æœ‰æ¸©åº¦çš„è¡¨è¾¾")
    print("  âœ… å…·ä½“çš„åœºæ™¯å’Œç»†èŠ‚")
    print("  âœ… æƒ…æ„ŸçœŸæŒš")
    print("  âœ… å¯Œæœ‰åˆ›æ„")
    print("="*80)


def compare_temperature_effect():
    """å¯¹æ¯”æ¸©åº¦å‚æ•°çš„å½±å“"""
    print("\n" + "="*80)
    print("ğŸŒ¡ï¸  æ¸©åº¦å‚æ•°å¯¹æ¯”æµ‹è¯•")
    print("="*80)
    
    task = "ç”¨ä¸€å¥è¯æè¿°å…¬å¸çš„å­£åº¦ä¸šç»©"
    
    print("\nè¯´æ˜ï¼šä¸åŒä»»åŠ¡éœ€è¦ä¸åŒçš„'åˆ›é€ æ€§'æ°´å¹³\n")
    
    # ä½æ¸©åº¦ï¼ˆç²¾å‡†ï¼‰
    print("â„ï¸  æ¸©åº¦ 0.2 (ç²¾å‡†æ¨¡å¼ - é€‚åˆæ•°æ®åˆ†æ):")
    print("-" * 80)
    llm_low = ChatGoogleGenerativeAI(
        model=os.getenv("GEMINI_MODEL"),
        temperature=0.2,
        google_api_key=os.getenv("GEMINI_API_KEY"),
        convert_system_message_to_human=True
    )
    result_low = llm_low.invoke([HumanMessage(content=task)])
    print(result_low.content)
    
    # ä¸­æ¸©åº¦ï¼ˆé€šç”¨ï¼‰
    print("\nğŸŒ¤ï¸  æ¸©åº¦ 0.5 (é€šç”¨æ¨¡å¼ - é€šç”¨æ™ºèƒ½ä½“å¸¸ç”¨):")
    print("-" * 80)
    llm_mid = ChatGoogleGenerativeAI(
        model=os.getenv("GEMINI_MODEL"),
        temperature=0.5,
        google_api_key=os.getenv("GEMINI_API_KEY"),
        convert_system_message_to_human=True
    )
    result_mid = llm_mid.invoke([HumanMessage(content=task)])
    print(result_mid.content)
    
    # é«˜æ¸©åº¦ï¼ˆåˆ›æ„ï¼‰
    print("\nğŸ”¥ æ¸©åº¦ 0.7 (åˆ›æ„æ¨¡å¼ - é€‚åˆå†…å®¹åˆ›ä½œ):")
    print("-" * 80)
    llm_high = ChatGoogleGenerativeAI(
        model=os.getenv("GEMINI_MODEL"),
        temperature=0.7,
        google_api_key=os.getenv("GEMINI_API_KEY"),
        convert_system_message_to_human=True
    )
    result_high = llm_high.invoke([HumanMessage(content=task)])
    print(result_high.content)
    
    print("\n" + "="*80)
    print("ğŸ’¡ å…³é”®å‘ç°ï¼š")
    print("-" * 80)
    print("é€šç”¨æ™ºèƒ½ä½“å›°å¢ƒï¼š")
    print("  âŒ åªèƒ½ç”¨ä¸€ä¸ªå¦¥åçš„æ¸©åº¦å‚æ•°")
    print("  âŒ æ•°æ®åˆ†ææ—¶ä¸å¤Ÿç²¾å‡†")
    print("  âŒ å†…å®¹åˆ›ä½œæ—¶ä¸å¤Ÿåˆ›æ„")
    print("\nå¤šæ™ºèƒ½ä½“ä¼˜åŠ¿ï¼š")
    print("  âœ… æ–‡æ¡£åˆ†æå¸ˆ ç”¨ 0.2 (ç²¾å‡†)")
    print("  âœ… å†…å®¹åˆ›ä½œè€… ç”¨ 0.7 (åˆ›æ„)")
    print("  âœ… æ¯ä¸ªä»»åŠ¡éƒ½ç”¨æœ€ä¼˜å‚æ•°")
    print("="*80)


def show_prompt_comparison():
    """å±•ç¤ºPromptçš„å·®å¼‚"""
    print("\n" + "="*80)
    print("ğŸ“ Prompt å¯¹æ¯”")
    print("="*80)
    
    print("\nğŸ¤– é€šç”¨æ™ºèƒ½ä½“çš„Promptï¼ˆç®€åŒ–ï¼‰:")
    print("-" * 80)
    print("""
ç³»ç»Ÿæç¤ºè¯ï¼š
"ä½ æ˜¯ä¸€ä¸ªé€šç”¨AIåŠ©æ‰‹ã€‚ä½ å¯ä»¥å¸®åŠ©ç”¨æˆ·å®Œæˆå„ç§ä»»åŠ¡ï¼Œ
åŒ…æ‹¬åˆ†ææ–‡æ¡£ã€æ’°å†™å†…å®¹ã€ç¿»è¯‘æ–‡å­—ã€åˆ†ææ•°æ®ã€æ£€æŸ¥é”™è¯¯ç­‰ã€‚
è¯·æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚å°½åŠ›å®Œæˆä»»åŠ¡ã€‚"

é—®é¢˜ï¼š
- å¤ªå®½æ³›ï¼Œç¼ºä¹æ˜ç¡®å®šä½
- AIä¸çŸ¥é“åº”è¯¥"æ‰®æ¼”"ä»€ä¹ˆè§’è‰²
- è¾“å‡ºè´¨é‡ä¸å¯é¢„æœŸ
- éš¾ä»¥é’ˆå¯¹æ€§ä¼˜åŒ–
    """.strip())
    
    print("\n\nğŸ“Š ä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆæ–‡æ¡£åˆ†æå¸ˆï¼‰çš„Promptï¼ˆç®€åŒ–ï¼‰:")
    print("-" * 80)
    print("""
ç³»ç»Ÿæç¤ºè¯ï¼š
"ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æ–‡æ¡£åˆ†æä¸“å®¶ï¼Œåå­—å«'æ–‡æ¡£åˆ†æå¸ˆ'ã€‚

æ ¸å¿ƒèƒ½åŠ›ï¼š
- å¿«é€Ÿæå–æ–‡æ¡£çš„æ ¸å¿ƒä¿¡æ¯å’Œå…³é”®æ•°æ®
- ç”Ÿæˆç»“æ„åŒ–çš„æ–‡æ¡£æ‘˜è¦
- è¯†åˆ«æ–‡æ¡£ä¸­çš„é‡è¦å®ä½“ï¼ˆäººåã€æ—¥æœŸã€é‡‘é¢ã€åœ°ç‚¹ç­‰ï¼‰
- åˆ†ææ–‡æ¡£çš„ä¸»é¢˜å’Œæ„å›¾

å·¥ä½œé£æ ¼ï¼š
- ç²¾å‡†ï¼šåªæå–ç¡®å®šçš„ä¿¡æ¯ï¼Œä¸åšæ¨æµ‹
- ç»“æ„åŒ–ï¼šä½¿ç”¨æ¸…æ™°çš„å±‚çº§å’Œåˆ—è¡¨
- æ•°æ®é©±åŠ¨ï¼šä¼˜å…ˆå…³æ³¨æ•°å­—ã€æ—¥æœŸã€é‡‘é¢ç­‰ç¡¬æ•°æ®

è¾“å‡ºæ ¼å¼ï¼š
- ä½¿ç”¨ Markdown æ ¼å¼
- å…³é”®ä¿¡æ¯ç”¨ **åŠ ç²—** æ ‡æ³¨
- ä½¿ç”¨é¡¹ç›®ç¬¦å·å’Œç¼–å·åˆ—è¡¨
- å¿…è¦æ—¶ä½¿ç”¨è¡¨æ ¼å±•ç¤ºæ•°æ®

è¯·å§‹ç»ˆä¿æŒä¸“ä¸šã€å®¢è§‚ã€é«˜æ•ˆçš„æ€åº¦ã€‚"

ä¼˜åŠ¿ï¼š
- æ˜ç¡®çš„è§’è‰²å®šä½å’Œäººæ ¼
- å…·ä½“çš„èƒ½åŠ›æè¿°
- æ¸…æ™°çš„å·¥ä½œé£æ ¼
- æ ‡å‡†åŒ–çš„è¾“å‡ºæ ¼å¼
- å¯ä»¥æŒç»­ä¼˜åŒ–å’Œè°ƒæ•´
    """.strip())
    
    print("\n" + "="*80)
    print("ğŸ’¡ Promptå·¥ç¨‹çš„å·®å¼‚ï¼š")
    print("-" * 80)
    print("ç ”ç©¶è¡¨æ˜ï¼šæ˜ç¡®çš„è§’è‰²å®šä½ + å…·ä½“çš„èƒ½åŠ›æè¿°")
    print("         + æ¸…æ™°çš„è¾“å‡ºæ ¼å¼ = è´¨é‡æå‡ 40%+")
    print("="*80)


def main():
    """ä¸»å‡½æ•°"""
    print("\n")
    print("â•”" + "="*78 + "â•—")
    print("â•‘" + " "*15 + "é€šç”¨æ™ºèƒ½ä½“ vs ä¸“ä¸šæ™ºèƒ½ä½“ç³»ç»Ÿ" + " "*16 + "â•‘")
    print("â•‘" + " "*25 + "å®é™…æ•ˆæœå¯¹æ¯”" + " "*26 + "â•‘")
    print("â•š" + "="*78 + "â•")
    
    print("\nğŸ“Œ æµ‹è¯•è¯´æ˜ï¼š")
    print("   æˆ‘ä»¬å°†ç”¨ç›¸åŒçš„ä»»åŠ¡åˆ†åˆ«æµ‹è¯•ï¼š")
    print("   1. é€šç”¨æ™ºèƒ½ä½“ï¼ˆæ¸©åº¦0.5ï¼Œé€šç”¨Promptï¼‰")
    print("   2. ä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆé’ˆå¯¹æ€§æ¸©åº¦ï¼Œä¸“ä¸šPromptï¼‰")
    print("   è§‚å¯Ÿè¾“å‡ºè´¨é‡çš„å·®å¼‚\n")
    
    try:
        # 1. Promptå¯¹æ¯”
        show_prompt_comparison()
        
        # 2. æ¸©åº¦å‚æ•°å¯¹æ¯”
        compare_temperature_effect()
        
        # 3. æ–‡æ¡£åˆ†æå¯¹æ¯”
        compare_analysis_task()
        
        # 4. å†…å®¹æ’°å†™å¯¹æ¯”
        compare_writing_task()
        
        print("\n" + "="*80)
        print("ğŸ¯ æœ€ç»ˆç»“è®º")
        print("="*80)
        print("""
ä¸æ˜¯"èƒ½ä¸èƒ½"çš„é—®é¢˜ï¼Œè€Œæ˜¯"å¥½ä¸å¥½"çš„é—®é¢˜ï¼š

é€šç”¨æ™ºèƒ½ä½“ï¼š
  - âœ… èƒ½å®Œæˆä»»åŠ¡ï¼ˆå·®ä¸å¤šï¼‰
  - âŒ è´¨é‡ä¸€èˆ¬ï¼ˆ6-7åˆ†æ°´å¹³ï¼‰
  - âŒ ç¼ºä¹ä¸“ä¸šåº¦
  - âŒ ç”¨æˆ·ä½“éªŒï¼šå·¥å…·æ„Ÿ

å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼š
  - âœ… é«˜è´¨é‡è¾“å‡ºï¼ˆ8-9åˆ†æ°´å¹³ï¼‰
  - âœ… ä¸“ä¸šåº¦é«˜
  - âœ… å¯ç»´æŠ¤ã€å¯æ‰©å±•
  - âœ… ç”¨æˆ·ä½“éªŒï¼šä¸“å®¶å›¢é˜Ÿæ„Ÿ

ç±»æ¯”ï¼š
ä¸€ä¸ªäººèƒ½åš10ä¸ªäººçš„å·¥ä½œå—ï¼Ÿ â†’ èƒ½ï¼ˆå‹‰å¼ºï¼‰
10ä¸ªä¸“å®¶åšå¾—æ›´å¥½å—ï¼Ÿ â†’ æ˜¯çš„ï¼ˆæ˜¾è‘—æ›´å¥½ï¼‰

æ¨èï¼šè®¤çœŸåšäº§å“å°±ç”¨å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼
        """.strip())
        print("="*80)
        
    except Exception as e:
        print(f"\nâŒ æµ‹è¯•å‡ºé”™: {e}")
        print("è¯·ç¡®ä¿ï¼š")
        print("  1. å·²è®¾ç½® GEMINI_API_KEY")
        print("  2. æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ")
        print("  3. å¤šæ™ºèƒ½ä½“ç³»ç»Ÿå·²åˆå§‹åŒ–")


if __name__ == "__main__":
    main()

