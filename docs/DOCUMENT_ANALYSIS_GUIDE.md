# AgentDesk 文档分析功能完全指南

## 🎯 核心定位

AgentDesk 的核心是**文档智能分析**，而不仅仅是简单的文档处理。通过多智能体协作和向量检索技术，实现深度的文档理解和洞察。

---

## 📊 文档分析能力矩阵

### 1. 基础分析（文档分析师）

**功能**：
- ✅ 信息提取（关键数据、日期、人名、金额）
- ✅ 文档摘要（核心要点提炼）
- ✅ 结构化分析（章节、段落、逻辑关系）
- ✅ 表格提取和数据提取

**使用方式**：
```
@文档分析师 分析这份投资报告，提取关键投资建议和风险提示
```

---

### 2. 深度分析（知识管理专家 + RAG）

**功能**：
- ✅ 多文档关联分析
- ✅ 跨文档信息综合
- ✅ 语义检索（理解查询意图）
- ✅ 精准引用（每个结论都有出处）

**使用方式**：
```bash
# 1. 将文档添加到知识库
curl -X POST -F "file=@报告1.pdf" http://localhost:8000/api/knowledge/add
curl -X POST -F "file=@报告2.pdf" http://localhost:8000/api/knowledge/add

# 2. 进行分析
@知识管理专家 对比这两份报告对科技板块的投资观点有什么不同？
```

---

### 3. 数据分析（数据专家）

**功能**：
- ✅ 财务数据分析
- ✅ 趋势识别
- ✅ 数据对比
- ✅ 可视化建议

**使用方式**：
```
@数据专家 分析这份财报中的营收增长趋势，并与去年同期对比
```

---

### 4. 合规分析（合规官）

**功能**：
- ✅ 合规检查
- ✅ 风险识别
- ✅ 政策解读
- ✅ 合规建议

**使用方式**：
```
@合规官 审查这份营销材料，确保符合《基金宣传推介材料管理规定》
```

---

## 🔥 核心优势

### 优势 1：多智能体协作

不同于单一 AI，AgentDesk 通过 **8 个专业智能体** 协同工作：

```
复杂任务示例：
用户："分析这份年报，生成投资者报告"

工作流程：
1. 📊 文档分析师 → 提取关键数据
2. 📈 数据专家 → 分析财务指标
3. ✍️ 内容创作者 → 生成报告初稿
4. ✅ 校对编辑 → 优化表达
5. ⚖️ 合规官 → 审核合规性
```

### 优势 2：RAG 增强检索

基于 **ChromaDB + Gemini Embeddings** 的向量检索：

```
传统搜索：
"营收增长" → 只能找到包含这些词的句子

RAG 检索：
"公司盈利能力如何？" → 理解意图，找到营收、利润、毛利率等相关内容
```

### 优势 3：可追溯性

每个分析结论都标注原文出处：

```markdown
**分析结论**：公司 2024 年营收同比增长 25%

**来源**：
- 文档：2024年度财报.pdf
- 页码：第 3 页
- 原文："2024年度营业收入 125 亿元，较 2023 年增长 25%"
- 相似度：0.95
```

---

## 💡 实战场景

### 场景 1：投资研报分析

**需求**：分析多份行业研报，提炼投资机会

**步骤**：

1. **上传文档到知识库**
```bash
curl -X POST -F "file=@科技行业研报.pdf" http://localhost:8000/api/knowledge/add
curl -X POST -F "file=@新能源研报.pdf" http://localhost:8000/api/knowledge/add
curl -X POST -F "file=@医药行业研报.pdf" http://localhost:8000/api/knowledge/add
```

2. **多维度分析**
```
@知识管理专家 总结所有研报中提到的投资机会，按行业分类

@数据专家 对比各行业的预期收益率和风险等级

@内容创作者 基于以上分析，生成一份投资建议报告
```

3. **合规审核**
```
@合规官 审核投资建议报告，确保符合监管要求
```

---

### 场景 2：财务报表对比分析

**需求**：对比公司近三年财报，分析经营趋势

**步骤**：

1. **上传财报**
```bash
curl -X POST -F "file=@2022年报.pdf" http://localhost:8000/api/knowledge/add
curl -X POST -F "file=@2023年报.pdf" http://localhost:8000/api/knowledge/add
curl -X POST -F "file=@2024年报.pdf" http://localhost:8000/api/knowledge/add
```

2. **趋势分析**
```
@知识管理专家 提取近三年的营收、净利润、毛利率数据

@数据专家 分析这些指标的变化趋势，识别异常波动

@文档分析师 提取管理层对业绩变化的解释说明
```

---

### 场景 3：政策文件解读

**需求**：理解新监管政策，评估对业务的影响

**步骤**：

1. **上传政策文件和业务文档**
```bash
curl -X POST -F "file=@新监管政策.pdf" http://localhost:8000/api/knowledge/add
curl -X POST -F "file=@公司业务介绍.pdf" http://localhost:8000/api/knowledge/add
```

2. **政策解读**
```
@合规官 解读新政策的核心要求和关键变化

@知识管理专家 找出公司业务中可能受影响的部分

@内容创作者 生成合规整改建议报告
```

---

### 场景 4：尽职调查

**需求**：对投资标的进行全面分析

**步骤**：

1. **上传所有材料**
```bash
# 上传财报、招股书、行业研报、新闻报道等
for file in *.pdf; do
    curl -X POST -F "file=@$file" http://localhost:8000/api/knowledge/add
done
```

2. **全方位分析**
```
@知识管理专家 汇总公司的基本面信息（营收、利润、市场份额）

@数据专家 分析财务健康度和成长性

@合规官 识别潜在的合规风险和法律风险

@协调者 综合以上分析，生成尽职调查报告
```

---

## 🚀 高级功能

### 1. 知识图谱（规划中）

自动构建文档间的关系网络：
```
公司A ─投资→ 公司B
   │
   └─竞争→ 公司C ─合作→ 公司D
```

### 2. 时间轴分析（规划中）

追踪事件发展脉络：
```
2022.01 → 政策发布
2022.03 → 公司响应
2022.06 → 业务调整
2023.01 → 成效显现
```

### 3. 对比视图（规划中）

并排对比多份文档：
```
┌─────────────┬─────────────┬─────────────┐
│   2022年报  │   2023年报  │   2024年报  │
├─────────────┼─────────────┼─────────────┤
│ 营收: 100亿 │ 营收: 120亿 │ 营收: 150亿 │
│ 增长: +5%   │ 增长: +20%  │ 增长: +25%  │
└─────────────┴─────────────┴─────────────┘
```

---

## 📝 最佳实践

### 1. 文档准备

**✅ 推荐**：
- 文档命名清晰（如：`2024Q3财报_公司A.pdf`）
- 按类别组织（财报/研报/政策）
- 文字清晰可读

**❌ 避免**：
- 扫描版 PDF（识别率低）
- 文件名模糊（如：`文档1.pdf`）
- 文件过大（超过 50MB）

### 2. 查询优化

**✅ 好的查询**：
```
具体明确：公司 2024 年的营收增长率是多少？
带上下文：对比 A 公司和 B 公司的盈利能力
多维度：分析这份报告的投资观点、风险提示和目标价位
```

**❌ 不好的查询**：
```
太宽泛：这份文档讲了什么？
太模糊：帮我分析一下
单个词：营收
```

### 3. 智能体选择

| 任务类型 | 推荐智能体 |
|---------|-----------|
| 信息提取 | 文档分析师 |
| 多文档检索 | 知识管理专家 |
| 财务分析 | 数据专家 |
| 内容生成 | 内容创作者 |
| 文字润色 | 校对编辑 |
| 翻译 | 翻译专家 |
| 合规审核 | 合规官 |
| 复杂任务 | 协调者 |

---

## 🔧 API 使用

### Python 示例

```python
import requests

# 1. 添加文档到知识库
with open('report.pdf', 'rb') as f:
    response = requests.post(
        'http://localhost:8000/api/knowledge/add',
        files={'file': f}
    )
    doc_id = response.json()['doc_id']

# 2. 搜索知识库
response = requests.post(
    'http://localhost:8000/api/knowledge/search',
    data={'query': '营收增长趋势', 'k': 5}
)
results = response.json()['results']

# 3. 与智能体对话
response = requests.post(
    'http://localhost:8000/api/chat',
    json={
        'message': '@知识管理专家 分析营收增长的原因',
        'agent': '知识管理专家'
    }
)
```

---

## 💎 总结

**AgentDesk 的核心价值**：

1. **专业化分工**：8 个专业智能体，术业有专攻
2. **智能检索**：RAG 技术，理解语义而非关键词匹配
3. **可追溯**：每个结论都有原文出处
4. **协同工作**：复杂任务自动分解和协作
5. **资管专注**：针对资管行业深度优化

**适用场景**：
- ✅ 投资研究和尽职调查
- ✅ 财务报表分析
- ✅ 合规审核和风险控制
- ✅ 政策解读和行业分析
- ✅ 多文档对比和综合分析

---

**开始使用 AgentDesk 进行文档分析！** 📊✨




